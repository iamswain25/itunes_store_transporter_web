<style>
  td { padding: 6px 12px; }
</style>

<h1 id="itunes-store-transporter-gui---help">iTunes Store Transporter: GUI - Help</h1>

<h2 id="table-of-contents">Table of Contents</h2>

<ul>
  <li><a href="#api">API</a></li>
  <li><a href="#notification-templates">Notification Templates</a></li>
</ul>

<h2 id="api">API</h2>

<p>All responses have a content type of <code>application/json</code>.</p>

<h3 id="response-objects">Response Objects</h3>

<h4 id="job">Job</h4>

<p>Represents a Transporter GUI job. Here’s an example for a queued, upload job:</p>

<pre><code>{
  "id": 112,
  "type": "upload"
  "state": "queued",
  "options": {
	"package": "/some/package.itmsp",
	"delete": false,
	"username": "fofinha123",
	"password": "shhhhh!",
	"shortname": "sshaw",
	"batch": null
  },
  "result": null,
  "exceptions": null,
  "created_at": "2016-11-19T20:01:07.373Z",
  "updated_at": "2016-11-19T20:01:07.373Z",
  "priority": "normal",
  "account_id": 12,
  "disable_notification": false
}
</code></pre>

<p>Here’s one for a failed verify job:</p>

<pre><code>{
  "id": 105,
  "type": "verify",
  "state": "failure",
  "options": {
	"package": "/Users/sshaw/Desktop/982345323555.itmsp",
	"batch": true,
	"verify_assets": false,
	"username": "user@example.com",
	"password": "123",
	"shortname": "shorty"
  },
  "result": null,
  "exceptions": "Feature is missing a checksum (5011), Playlist already exits for this UPC (3005), Bad chapter timecode (4009), Preorder date must be before available date (4019)",
  "created_at": "2016-09-04T00:54:24.205Z",
  "updated_at": "2016-09-25T02:48:06.575Z",
  "priority": "normal",
  "account_id": 15,
  "disable_notification": false
}
</code></pre>

<h5 id="properties">Properties</h5>

<ul>
  <li><code>id</code> - job’s id</li>
  <li><code>type</code> - one of <code>lookup</code>, <code>providers</code>, <code>schema</code>, <code>status</code>, <code>upload</code>, <code>verify</code>, <code>version</code></li>
  <li><code>state</code> - one of <code>queued</code>, <code>running</code>, <code>success</code>, <code>failure</code></li>
  <li><code>options</code> - arguments passed to <code>iTMSTransporter</code>, this varies based on the job’s type, see Endpoints below</li>
  <li><code>result</code> - the results of a successful job, this varies based on the job type</li>
  <li><code>exceptions</code> - why the job failed</li>
  <li><code>disable_notification</code> - email notification’s are enabled/disabled for the job</li>
</ul>

<h4 id="errors">Errors</h4>

<p>Error responses with a non-HTTP 2XX status are considered errors.
With the exception of a HTTP 422 (see below) error responses contain a single property <code>error</code>,
whose value contains the error message:</p>

<pre><code>{"error":"Not found"}
</code></pre>

<p>With HTTP 422 response, each property is a request property and its value is an array that contains
the reasons why the give property was invalid. For example:</p>

<pre><code>{
  "account_id": [
	"unknown"
  ],
  "package": [
	"must end with \".itmsp\""
  ]
}
</code></pre>

<h3 id="endpoints">Endpoints</h3>

<h4 id="upload">Upload</h4>

<p>Create an upload package job</p>

<ul>
  <li>Endpoint: <code>/api/upload</code></li>
  <li>Method: <code>POST</code></li>
</ul>

<h4 id="request">Request</h4>

<h5 id="properties-1">Properties</h5>

<ul>
  <li><code>package</code>: Absolute path of the package to upload, this path must be accessible by the worker process</li>
  <li><code>disable_notification</code>: optional, disable email notifications for this job only</li>
  <li><code>rate</code>: optional, transfer rate in kbps</li>
  <li><code>batch</code> optional, defaults to <code>false</code>:</li>
  <li><code>success</code> optional:</li>
  <li><code>failure</code> optional:</li>
  <li><code>priority</code> optional, defaults to <code>"Normal"</code></li>
  <li><code>account_id</code>: The Transporter GUI ID of the account to use to upload the package</li>
  <li><code>delete</code> optional, defaults to <code>false</code>:</li>
  <li><code>transport</code> optional, defaults to ITMSTrasnporter’s default</li>
</ul>

<h3 id="verify">Verify</h3>

<ul>
  <li>Endpoint: <code>/api/verify</code></li>
  <li>Method: <code>POST</code></li>
</ul>

<h3 id="status">Status</h3>

<ul>
  <li>Endpoint: <code>/api/status</code></li>
  <li>Method: <code>POST</code></li>
</ul>

<p>…</p>

<h2 id="notification-templates">Notification Templates</h2>

<p><em>Notifications are currently only supported for upload jobs.</em></p>

<p>The subject and message fields of notifications can contain <a href="https://en.wikipedia.org/wiki/ERuby">ERB</a>.
See the below table for the supported variables.</p>

<table>
  <thead>
    <tr>
      <th>Variable</th>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>job_id</code></td>
      <td><code>String</code></td>
      <td>Job id</td>
    </tr>
    <tr>
      <td><code>job_target</code></td>
      <td><code>String</code></td>
      <td>Job target, varies based on the job type</td>
    </tr>
    <tr>
      <td><code>job_package_path</code></td>
      <td><code>String</code></td>
      <td>Absolute path to the package, if the job contains one</td>
    </tr>
    <tr>
      <td><code>job_type</code></td>
      <td><code>String</code></td>
      <td>The type of job</td>
    </tr>
    <tr>
      <td><code>job_state</code></td>
      <td><code>String</code></td>
      <td>Job state</td>
    </tr>
    <tr>
      <td><code>job_created</code></td>
      <td><code>Time</code></td>
      <td>Time the job was created</td>
    </tr>
    <tr>
      <td><code>job_completed</code></td>
      <td><code>Time</code></td>
      <td>Time the job finished</td>
    </tr>
    <tr>
      <td><code>account_username</code></td>
      <td><code>String</code></td>
      <td>Username of the package’s iTunes Connect account</td>
    </tr>
    <tr>
      <td><code>account_shortname</code></td>
      <td><code>String</code></td>
      <td>Shortname of the package’s iTunes Connect account (can be <code>nil</code>)</td>
    </tr>
    <tr>
      <td><code>email_to</code></td>
      <td><code>Array</code></td>
      <td>Recipient email addresses</td>
    </tr>
    <tr>
      <td><code>email_from</code></td>
      <td><code>String</code></td>
      <td>Sender’s email address</td>
    </tr>
    <tr>
      <td><code>email_reply_to</code></td>
      <td><code>String</code></td>
      <td>Reply to email address (can be <code>nil</code>)</td>
    </tr>
  </tbody>
</table>
